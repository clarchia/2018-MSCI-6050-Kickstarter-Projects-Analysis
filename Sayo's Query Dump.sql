
/*
Average Active Days, and average Amount Pledged by Sub Categories
*/
SELECT ROUND(AVG (PRO.ACTIVEDAYS)) AS Average_Number_of_Active_Days, CAT.SUBCATEGORY, 
    ROUND(AVG(PLEDGEDAMOUNT), 1) AS AVERAGE_AMOUNT_PLEDGED
FROM PROJECT_T PRO, COUNTRY_T COU, CATEGORY_T CAT, CALENDAR_T CAL
WHERE PRO.CATEGORYID = CAT.CATEGORYID
    AND PRO.COUNTRYCODE = COU.COUNTRYCODE
    AND PRO.DEADLINE = CAL.DATES
GROUP BY CAT.SUBCATEGORY
ORDER BY ROUND(AVG(PLEDGEDAMOUNT), 1) DESC;

/*
Total Pledged Amount by Day of Week for Successful Projects
*/
SELECT CAL.DAYOFWEEK, PRO.PROJECTSTATE, SUM(PRO.PLEDGEDAMOUNT)
FROM PROJECT_T PRO, COUNTRY_T COU, CATEGORY_T CAT, CALENDAR_T CAL
WHERE PRO.CATEGORYID = CAT.CATEGORYID
    AND PRO.COUNTRYCODE = COU.COUNTRYCODE
    AND PRO.DEADLINE = CAL.DATES
GROUP BY CAL.DAYOFWEEK, PRO.PROJECTSTATE
HAVING PRO.PROJECTSTATE = 'successful'
ORDER BY SUM(PRO.PLEDGEDAMOUNT) DESC;

/*
Total Pledged Amount by Day of Week and Project Status
*/
SELECT CAL.DAYOFWEEK, PRO.PROJECTSTATE, SUM(PRO.PLEDGEDAMOUNT)
FROM PROJECT_T PRO, COUNTRY_T COU, CATEGORY_T CAT, CALENDAR_T CAL
WHERE PRO.CATEGORYID = CAT.CATEGORYID
    AND PRO.COUNTRYCODE = COU.COUNTRYCODE
    AND PRO.DEADLINE = CAL.DATES
GROUP BY CAL.DAYOFWEEK, PRO.PROJECTSTATE
ORDER BY SUM(PLEDGEDAMOUNT) DESC;


/*
Total Amount Pledged by Year and ProjectState
*/
SELECT CAL.YEAR, PRO.PROJECTSTATE, SUM(PRO.PLEDGEDAMOUNT)
FROM PROJECT_T PRO, COUNTRY_T COU, CATEGORY_T CAT, CALENDAR_T CAL
WHERE PRO.CATEGORYID = CAT.CATEGORYID
    AND PRO.COUNTRYCODE = COU.COUNTRYCODE
    AND PRO.DEADLINE = CAL.DATES
GROUP BY CAL.YEAR, PRO.PROJECTSTATE
ORDER BY SUM(PLEDGEDAMOUNT) DESC;


/*
Total Amount Pledged by DayofWeek and ProjectState
*/
SELECT CAL.DAYOFWEEK, PRO.PROJECTSTATE, SUM(PRO.PLEDGEDAMOUNT)
FROM PROJECT_T PRO, COUNTRY_T COU, CATEGORY_T CAT, CALENDAR_T CAL
WHERE PRO.CATEGORYID = CAT.CATEGORYID
    AND PRO.COUNTRYCODE = COU.COUNTRYCODE
    AND PRO.DEADLINE = CAL.DATES
GROUP BY CAL.DAYOFWEEK, PRO.PROJECTSTATE
ORDER BY SUM(PLEDGEDAMOUNT) DESC;

/*
Total Amount Pledged by DayofWeek and Project State
*/
SELECT CAL.DAYOFWEEK, SUM(PRO.PLEDGEDAMOUNT)
FROM PROJECT_T PRO, COUNTRY_T COU, CATEGORY_T CAT, CALENDAR_T CAL
WHERE PRO.CATEGORYID = CAT.CATEGORYID
    AND PRO.COUNTRYCODE = COU.COUNTRYCODE
    AND PRO.DEADLINE = CAL.DATES
GROUP BY CAL.DAYOFWEEK
ORDER BY SUM(PLEDGEDAMOUNT) DESC;

/*
Total Amount Pledged by Main Categories
*/
SELECT CAT.MAINCATEGORY, SUM(PRO.PROPORTIONREACHED)
FROM PROJECT_T PRO, COUNTRY_T COU, CATEGORY_T CAT, CALENDAR_T CAL
WHERE PRO.CATEGORYID = CAT.CATEGORYID
    AND PRO.COUNTRYCODE = COU.COUNTRYCODE
    AND PRO.DEADLINE = CAL.DATES
GROUP BY CAT.MAINCATEGORY
ORDER BY SUM(PRO.PROPORTIONREACHED) DESC;


/*
Total Amount Pledged and Total Backers by Countries
*/
SELECT COU.COUNTRYCODE, SUM(PRO.PROPORTIONREACHED), SUM(PRO.BACKERS)
FROM PROJECT_T PRO, COUNTRY_T COU, CATEGORY_T CAT, CALENDAR_T CAL
WHERE PRO.CATEGORYID = CAT.CATEGORYID
    AND PRO.COUNTRYCODE = COU.COUNTRYCODE
    AND PRO.DEADLINE = CAL.DATES
GROUP BY COU.COUNTRYCODE
ORDER BY SUM(PRO.PROPORTIONREACHED) DESC;

/*
Number of Projects by Countries and Project State
*/
SELECT COU.COUNTRYCODE, PRO.PROJECTSTATE, COUNT(PRO.PROJECTID) AS NUM_OF_PROJECTS
FROM PROJECT_T PRO, COUNTRY_T COU, CATEGORY_T CAT, CALENDAR_T CAL
WHERE PRO.CATEGORYID = CAT.CATEGORYID
    AND PRO.COUNTRYCODE = COU.COUNTRYCODE
    AND PRO.DEADLINE = CAL.DATES
GROUP BY COU.COUNTRYCODE, PRO.PROJECTSTATE
ORDER BY COUNT(PRO.PROJECTSTATE) DESC;

/*
Total Number of Projects by Countries 
*/
SELECT COU.COUNTRYCODE, COUNT(PRO.PROJECTID) AS NUM_OF_PROJECTS
FROM PROJECT_T PRO, COUNTRY_T COU, CATEGORY_T CAT, CALENDAR_T CAL
WHERE PRO.CATEGORYID = CAT.CATEGORYID
    AND PRO.COUNTRYCODE = COU.COUNTRYCODE
    AND PRO.DEADLINE = CAL.DATES
GROUP BY COU.COUNTRYCODE
ORDER BY COUNT(PRO.PROJECTID) DESC;


/*
Total Number of Projects by Year and Project State
*/
SELECT CAL.YEAR, PRO.PROJECTSTATE, COUNT(PRO.PROJECTID) AS NUM_OF_PROJECTS
FROM PROJECT_T PRO, COUNTRY_T COU, CATEGORY_T CAT, CALENDAR_T CAL
WHERE PRO.CATEGORYID = CAT.CATEGORYID
    AND PRO.COUNTRYCODE = COU.COUNTRYCODE
    AND PRO.DEADLINE = CAL.DATES
GROUP BY CAL.YEAR, PRO.PROJECTSTATE
ORDER BY PRO.PROJECTSTATE, COUNT(PRO.PROJECTID) DESC;


/*
Total Number of Backers by Main Categories
*/
SELECT CAT.MAINCATEGORY, COUNT(PRO.BACKERS) AS NUM_OF_BACKERS
FROM PROJECT_T PRO, COUNTRY_T COU, CATEGORY_T CAT, CALENDAR_T CAL
WHERE PRO.CATEGORYID = CAT.CATEGORYID
    AND PRO.COUNTRYCODE = COU.COUNTRYCODE
    AND PRO.DEADLINE = CAL.DATES
GROUP BY CAT.MAINCATEGORY
ORDER BY COUNT(PRO.BACKERS) DESC;

/*
Total Number of Backers by Year
*/
SELECT CAL.YEAR, COUNT(PRO.BACKERS) AS NUM_OF_BACKERS
FROM PROJECT_T PRO, COUNTRY_T COU, CATEGORY_T CAT, CALENDAR_T CAL
WHERE PRO.CATEGORYID = CAT.CATEGORYID
    AND PRO.COUNTRYCODE = COU.COUNTRYCODE
    AND PRO.DEADLINE = CAL.DATES
GROUP BY CAL.YEAR
ORDER BY COUNT(PRO.BACKERS) DESC;

/*
Total Number of Projects by Categories that were successful
*/
SELECT CAT.MAINCATEGORY, PRO.PROJECTSTATE, COUNT(PRO.PROJECTID) AS NUM_OF_PROJECTS
FROM PROJECT_T PRO, COUNTRY_T COU, CATEGORY_T CAT, CALENDAR_T CAL
WHERE PRO.CATEGORYID = CAT.CATEGORYID
    AND PRO.COUNTRYCODE = COU.COUNTRYCODE
    AND PRO.DEADLINE = CAL.DATES
GROUP BY CAT.MAINCATEGORY, PRO.PROJECTSTATE
HAVING PRO.PROJECTSTATE = 'successful'
ORDER BY PRO.PROJECTSTATE, COUNT(PRO.PROJECTID) DESC;
                  
--HUTAN's queries
--Top 10 countries with highest number of projects
select distinct C.COUNTRYNAME, count(P.projectstate)
from project_t P join country_t C ON P.COUNTRYCODE = C.COUNTRYCODE
where rownum <= 374857
group by c.COUNTRYNAME
having count(projectstate) > 1756
order by count(projectstate) desc;
