
/*
Average Active Days, and average Amount Pledged by Sub Categories
*/

SELECT ROUND(AVG (PRO.ACTIVEDAYS)) AS Average_Number_of_Active_Days, CAT.SUBCATEGORY, 
    ROUND(AVG(PLEDGEDAMOUNT), 1) AS AVERAGE_AMOUNT_PLEDGED
FROM PROJECT_T PRO, COUNTRY_T COU, CATEGORY_T CAT, CALENDAR_T CAL
WHERE PRO.CATEGORYID = CAT.CATEGORYID
    AND PRO.COUNTRYCODE = COU.COUNTRYCODE
    AND PRO.DEADLINE = CAL.DATES
GROUP BY CAT.SUBCATEGORY
ORDER BY ROUND(AVG(PLEDGEDAMOUNT), 1) DESC;

/*
Total Pledged Amount by Day of Week for Successful Projects
*/

SELECT CAL.DAYOFWEEK, PRO.PROJECTSTATE, SUM(PRO.PLEDGEDAMOUNT)
FROM PROJECT_T PRO, COUNTRY_T COU, CATEGORY_T CAT, CALENDAR_T CAL
WHERE PRO.CATEGORYID = CAT.CATEGORYID
    AND PRO.COUNTRYCODE = COU.COUNTRYCODE
    AND PRO.DEADLINE = CAL.DATES
GROUP BY CAL.DAYOFWEEK, PRO.PROJECTSTATE
HAVING PRO.PROJECTSTATE = 'successful'
ORDER BY SUM(PRO.PLEDGEDAMOUNT) DESC;

/*
Total Pledged Amount by Day of Week and Project Status
*/

SELECT CAL.DAYOFWEEK, PRO.PROJECTSTATE, SUM(PRO.PLEDGEDAMOUNT)
FROM PROJECT_T PRO, COUNTRY_T COU, CATEGORY_T CAT, CALENDAR_T CAL
WHERE PRO.CATEGORYID = CAT.CATEGORYID
    AND PRO.COUNTRYCODE = COU.COUNTRYCODE
    AND PRO.DEADLINE = CAL.DATES
GROUP BY CAL.DAYOFWEEK, PRO.PROJECTSTATE
ORDER BY SUM(PLEDGEDAMOUNT) DESC;

SELECT CAL.YEAR, PRO.PROJECTSTATE, SUM(PRO.PLEDGEDAMOUNT)
FROM PROJECT_T PRO, COUNTRY_T COU, CATEGORY_T CAT, CALENDAR_T CAL
WHERE PRO.CATEGORYID = CAT.CATEGORYID
    AND PRO.COUNTRYCODE = COU.COUNTRYCODE
    AND PRO.DEADLINE = CAL.DATES
GROUP BY CAL.YEAR, PRO.PROJECTSTATE
ORDER BY SUM(PLEDGEDAMOUNT) DESC;

SELECT CAL.DAYOFWEEK, PRO.PROJECTSTATE, SUM(PRO.PLEDGEDAMOUNT)
FROM PROJECT_T PRO, COUNTRY_T COU, CATEGORY_T CAT, CALENDAR_T CAL
WHERE PRO.CATEGORYID = CAT.CATEGORYID
    AND PRO.COUNTRYCODE = COU.COUNTRYCODE
    AND PRO.DEADLINE = CAL.DATES
GROUP BY CAL.DAYOFWEEK, PRO.PROJECTSTATE
ORDER BY SUM(PLEDGEDAMOUNT) DESC;

SELECT CAT.MAINCATEGORY, SUM(PRO.PROPORTIONREACHED)
FROM PROJECT_T PRO, COUNTRY_T COU, CATEGORY_T CAT, CALENDAR_T CAL
WHERE PRO.CATEGORYID = CAT.CATEGORYID
    AND PRO.COUNTRYCODE = COU.COUNTRYCODE
    AND PRO.DEADLINE = CAL.DATES
GROUP BY CAT.MAINCATEGORY
ORDER BY SUM(PRO.PROPORTIONREACHED) DESC;

SELECT COU.COUNTRYCODE, SUM(PRO.PROPORTIONREACHED), SUM(PRO.BACKERS)
FROM PROJECT_T PRO, COUNTRY_T COU, CATEGORY_T CAT, CALENDAR_T CAL
WHERE PRO.CATEGORYID = CAT.CATEGORYID
    AND PRO.COUNTRYCODE = COU.COUNTRYCODE
    AND PRO.DEADLINE = CAL.DATES
GROUP BY COU.COUNTRYCODE
ORDER BY SUM(PRO.PROPORTIONREACHED) DESC;


SELECT COU.COUNTRYCODE, PRO.PROJECTSTATE, COUNT(PRO.PROJECTID) AS NUM_OF_PROJECTS
FROM PROJECT_T PRO, COUNTRY_T COU, CATEGORY_T CAT, CALENDAR_T CAL
WHERE PRO.CATEGORYID = CAT.CATEGORYID
    AND PRO.COUNTRYCODE = COU.COUNTRYCODE
    AND PRO.DEADLINE = CAL.DATES
GROUP BY COU.COUNTRYCODE, PRO.PROJECTSTATE
ORDER BY COUNT(PRO.PROJECTSTATE) DESC;



